<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1251">
<meta name=vs_targetSchema content="HTML 4.0">
</head><body>
<h3>Состав</h3>
<pre>
Пакет файлов для организации скриптового Watchdog-а.
      
qw.ini       - всё, что настраивается - здесь
qw.vbs       - главный скрипт
qwinfo.cmd   - просмотр заданий
qwrun.cmd    - вставка скрипта в расписание, вызывается из скрипта
qwstop.cmd   - удаление из расписания
qw.hta       - утилита с кнопочной формой для настройки 
ReadMe.htm   - этот файл
</pre>
<h3>Описание</h3>
<p>Предполагается, что во время мониторинга программа пишет что-то в базу данных и, соответственно,
меняет время последнего обновления файла данных. Если другую, независимую программу вставить в расписание, то 
можно организовать слежение за активностью первой программы. Так устроен ЭТОТ watchdog.</p>
<p>Watchdog вызывается с периодичностью delval+1 минут и проверяет промежуток времени, прошедшего после последнего обновления. Если в качестве datafile указан udl-файл, то watchdog делает запрос в адресуемую базу данных: 
"Select max(DateAndTime) from JustValues". Если прошедшее время больше delval, то окну программы wndname посылается
символ ctrl+Q, а затем принудительно завершается эта программа и вновь запускается командой cmd. Время перезапуска
записывается в файл "МОИ ДОКУМЕНТЫ\qw.log"</p>
<h3>Пример ini-файла</h3>
<pre>
datafile="C:\Program Files\Pdv_USB\pdmon.udl"
cmd="C:\Program Files\Pdv_USB\pdv_usb.exe"
ini="C:\Program Files\Pdv_USB\Pdv_USB.ini"
wndname="Корона-20"
delval=10
</pre>
<p>Управление watchdog-ом осуществляется из командной строки: <samp>qwinfo</samp> и <samp>qwrun</samp> - посмотреть расписание и запустить вне расписания, соответственно. Для вставки скрипта watchdoga в расписание windows нужно выполнить команду <samp>"qw.vbs 1"</samp>. Команда <samp>qwstop</samp> удаляет из расписания. Все операции по настройке
watchdoga можно также выполнить с пощью <a href="qw.hta">утилиты настройки</a>.</p>
<h3>Назначение кнопок</h3>
<button>info</button> - проверить наличие скрипта в расписании windows scheduler<br>
<button>qw.ini</button> - просмотреть файл настроек, настройки можно редактировать вручную<br>
<button>UDL</button> - послать запрос в базу данных<br>
<button>save</button> - сохранить содержимое окна в файл настроек<br>
<button>setup</button> - вставить скрипт в расписание<br>
<button>&nbsp;run&nbsp;</button> - выполнить вставленное в расписание задание<br>
<button>stop</button> - удалить из расписания
</body></html>