<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1251">
</head><body>
<h3>Состав ПО</h3>
<pre>
Комплект программ для регистратора:
skil2.exe    - обработка файлов, нарезка, рассылка, включается по необходимости
rgpn2.exe    - только регистрация и запись на диск, включен постоянно
readrems.exe - watchdog, heartbit и взаимодействие с сервером, включается по расписанию
rgpna.exe    - настройка всего ПО

Настройки:
ххх.ini		- настройки регистратора, где ххх - номер регистратора
rgpn2.ini	- содержит указание на номер(а) регистратора
glu.ini		- настройки для watchdog-а

Командные файлы:
qwrun.cmd	- включение watchdog-а
qwinfo.cmd	- проверка watchdog-а
qwstop.cmd	- отключение watchdog-а
</pre>
<h3>RGPN2.EXE</h3>
<p>Программа предназначена для обеспечения функционирования оборудования в одном из 
двух режимов записи регистрограмм: по расписанию или по событию.</p>
<p>Программа запускается при включении компьютера и работает постоянно. Поскольку одна 
регистрограмма занимает в памяти около 30 Мб, то эта программа построена с минимальным
набором функций и интерфейсов. Программа построена с привлечением двух основных потоков
по схеме производитель-потребитель. Первый поток управляет АЦП и GPS-приемником и осуществлет
считывание данных. Второй - выполняет запись данных на диск в формате TDMS. Связь между 
потоками обеспечивается посредством очереди на 25 регистрограмм. Для генерации несовпадающих
имен файлов используются отметки времени начала регистрограммы в формате UTC.</p>
<p>Для целей самодиагностики в программе организована запись короткого файла lasttime.txt, в котором указано 
текущее время. Запись производится 2-3 раза в секунду. Сравнивая текущее время и время, 
записанное в файл, можно судить о работе регистратора.</p>
<h3>SKIL2.EXE</h3>
<p>Программа выполняет предварительную обработку данных из файлов и отправку их на сервер. Программа 
вызывается из программы watchdog-а при наличии файлов для отправки.</p>
<p>Предварительная обработка включает фильтрацию и сжатие файлов до размера, пригодного для пересылки через интернет.
Успешно обработанные файлы либо удаляются, либо перемещаются в папку для отправленных файлов, 
в соответствии с настройками для регистратора.</p>
<p>Сжатие регистрограмм выполняется по разным алгоритмам в зависимости от 
<a href="http://smgr-devel.alwaysdata.net/doku.php?id=file_format">формата файла</a> для пересылки: 
<nobr>СМГР-0.1</nobr> или <nobr>СМГР-0.2</nobr>. Для генерации формата 0.1 используется алгоритм
прореживания заменой каждой выборки из 100 точек одной точкой с наибольшей разностью от предыдущей.
<img src="split2d.png"><img src="compress1.png"></p>
<p>Для генерации СМГР-0.2 применяется прореживание путём удаления промежутков где уровень сигнала
не отличим от шумов. Определение порогов осуществляется на основе статистических характеристик
регистрограммы: среднего и среднеквадратичного отклонения. <img src="stat_f_s1.png"></p>
<p>Результаты работы программы (список обработанных файлов) выводится в файл sent.log.</p>
<h3>READREMS.EXE</h3>
<p>Программа выполняет сервисные функции: сброс аппаратного watchdog-а, проверку работы регистратора и 
его перезапуск при необходимости, отправку сообщения "живой" серверу, проверку записанных файлов и вызов
обработчика записей, чтение команд с сервера и их выполнение. Программа предназначена для вызова из 
планировщика WINDOWS. Такая конфигурация повышает надёжность всей системы, поскольку, отказ планировщика 
вызовет срабатывание аппаратного watchdog-а и перезагрузку компьютера. </p>
<p>Программы smgr2.exe и skil2.exe одновременно являются active-x серверами, поэтому watchdog обращается к ним
как к сервисам.</p>
<p>Результат работы watchdog-а записывается в файл wd.log.</p>
<h3>RGPNA.EXE</h3>
<p>Программа предназначена для облегчения настройки и проверки всего комплекса регистратора.
Запускается только вручную.</p>
<h3>Установка</h3>
<p>1. Для саморегистрации программы skil2.exe и rgpn2.exe нужно запустить один раз с правами администратора!</p>
<p>2. Создать задачу в планировщик WINDOWS. Например, командой <nobr><code>schtasks /create /sc minute /mo 5 /tn watchdog /tr "'c:\work\lv2010\skil\skil\my application\readrems.exe'"</code></nobr>, см. qwrun.cmd. </p>
<p>3. Создать ярлык в Автозагрузку для аппаратного таймера watchdog-а, см. autoexec.cmd.</p>
</body></html>